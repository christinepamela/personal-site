<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Cap Table Management System</title>
    <style>
        /* Base Styles */
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }

        /* Component Styling */
        .calculator-section {
            background-color: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        /* Table Styling */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background-color: white;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }

        th {
            background-color: #f8f9fa;
            font-weight: 600;
        }

        /* Form Elements */
        .input-group {
            margin-bottom: 15px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            color: #666;
            font-weight: 500;
        }

        input, select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }

        /* Button Styling */
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #0056b3;
        }

        /* Tab Navigation */
        .tab {
            overflow: hidden;
            border: 1px solid #ccc;
            background-color: #f1f1f1;
            border-radius: 4px 4px 0 0;
        }

        .tab button {
            background-color: inherit;
            float: left;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 14px 16px;
            transition: 0.3s;
            margin: 0;
        }

        .tab button:hover {
            background-color: #ddd;
        }

        .tab button.active {
            background-color: #007bff;
            color: white;
        }

        .tabcontent {
            display: none;
            padding: 20px;
            border: 1px solid #ccc;
            border-top: none;
            border-radius: 0 0 4px 4px;
        }

        /* Cards and Info Boxes */
        .info-card {
            background-color: #f8f9fa;
            border-left: 4px solid #007bff;
            padding: 15px;
            margin: 10px 0;
            border-radius: 4px;
        }

        .warning {
            border-left-color: #ffc107;
        }

        .success {
            border-left-color: #28a745;
        }

        /* Summary Statistics */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .stat-card {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            text-align: center;
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #007bff;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .input-group {
                grid-template-columns: 1fr;
            }
            
            .stats-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <h1>Advanced Cap Table Management System</h1>

    <!-- Tab Navigation -->
    <div class="tab">
        <button class="tablinks active" onclick="openTab(event, 'Overview')">Overview</button>
        <button class="tablinks" onclick="openTab(event, 'Shareholders')">Shareholders</button>
        <button class="tablinks" onclick="openTab(event, 'Investments')">Investments</button>
        <button class="tablinks" onclick="openTab(event, 'Options')">Options</button>
        <button class="tablinks" onclick="openTab(event, 'Vesting')">Vesting</button>
        <button class="tablinks" onclick="openTab(event, 'Analytics')">Analytics</button>
    </div>

    <!-- Overview Tab -->
    <div id="Overview" class="tabcontent" style="display: block;">
        <div class="calculator-section">
            <h2>Company Information</h2>
            <div class="input-group">
                <div>
                    <label>Company Name:</label>
                    <input type="text" id="companyName">
                </div>
                <div>
                    <label>Incorporation Date:</label>
                    <input type="date" id="incorporationDate">
                </div>
                <div>
                    <label>Fiscal Year End:</label>
                    <input type="date" id="fiscalYearEnd">
                </div>
            </div>

            <h3>Share Structure</h3>
            <div class="input-group">
                <div>
                    <label>Authorized Common Shares:</label>
                    <input type="number" id="authorizedCommon" value="10000000">
                </div>
                <div>
                    <label>Authorized Preferred Shares:</label>
                    <input type="number" id="authorizedPreferred" value="2000000">
                </div>
                <div>
                    <label>Par Value:</label>
                    <input type="number" id="parValue" step="0.0001" value="0.0001">
                </div>
            </div>

            <div class="stats-container">
                <div class="stat-card">
                    <h4>Total Shares Outstanding</h4>
                    <div class="stat-value" id="totalSharesOutstanding">0</div>
                </div>
                <div class="stat-card">
                    <h4>Current Valuation</h4>
                    <div class="stat-value" id="currentValuation">$0</div>
                </div>
                <div class="stat-card">
                    <h4>Available Option Pool</h4>
                    <div class="stat-value" id="availableOptionPool">0</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Shareholders Tab -->
    <div id="Shareholders" class="tabcontent">
        <div class="calculator-section">
            <h2>Manage Shareholders</h2>
            <div class="input-group">
                <div>
                    <label>Shareholder Type:</label>
                    <select id="shareholderType">
                        <option value="founder">Founder</option>
                        <option value="investor">Investor</option>
                        <option value="employee">Employee</option>
                        <option value="advisor">Advisor</option>
                    </select>
                </div>
                <div>
                    <label>Name:</label>
                    <input type="text" id="shareholderName">
                </div>
                <div>
                    <label>Share Class:</label>
                    <select id="shareClass">
                        <option value="commonA">Common Class A (1 vote)</option>
                        <option value="commonB">Common Class B (10 votes)</option>
                        <option value="preferred">Preferred Series</option>
                    </select>
                </div>
                <div>
                    <label>Number of Shares:</label>
                    <input type="number" id="shareCount">
                </div>
                <div>
                    <label>Issue Price:</label>
                    <input type="number" id="issuePrice" step="0.01">
                </div>
            </div>
            <button onclick="addShareholder()">Add Shareholder</button>
            
            <h3>Current Shareholders</h3>
            <div id="shareholdersTable"></div>
        </div>
    </div>

    <!-- Investments Tab -->
    <div id="Investments" class="tabcontent">
        <div class="calculator-section">
            <h2>Investment Rounds</h2>
            <div class="input-group">
                <div>
                    <label>Round Type:</label>
                    <select id="roundType">
                        <option value="seed">Seed</option>
                        <option value="seriesA">Series A</option>
                        <option value="seriesB">Series B</option>
                        <option value="seriesC">Series C</option>
                    </select>
                </div>
                <div>
                    <label>Pre-money Valuation:</label>
                    <input type="number" id="preMoneyVal">
                </div>
                <div>
                    <label>Investment Amount:</label>
                    <input type="number" id="investmentAmount">
                </div>
                <div>
                    <label>Price Per Share:</label>
                    <input type="number" id="pricePerShare" step="0.01">
                </div>
            </div>
            <button onclick="addInvestmentRound()">Add Investment Round</button>

            <h3>SAFE Notes</h3>
            <div class="input-group">
                <div>
                    <label>Investor Name:</label>
                    <input type="text" id="safeInvestorName">
                </div>
                <div>
                    <label>Investment Amount:</label>
                    <input type="number" id="safeAmount">
                </div>
                <div>
                    <label>Valuation Cap:</label>
                    <input type="number" id="valuationCap">
                </div>
                <div>
                    <label>Discount Rate (%):</label>
                    <input type="number" id="discountRate" max="100">
                </div>
            </div>
            <button onclick="addSAFENote()">Add SAFE Note</button>

            <div id="investmentsTable"></div>
        </div>
    </div>

    <!-- Options Tab -->
    <div id="Options" class="tabcontent">
        <div class="calculator-section">
            <h2>Employee Stock Option Pool</h2>
            <div class="input-group">
                <div>
                    <label>Pool Size (%):</label>
                    <input type="number" id="poolSize" max="100" value="10">
                </div>
                <div>
                    <label>Reserved Shares:</label>
                    <input type="number" id="reservedShares">
                </div>
            </div>

            <h3>Grant Options</h3>
            <div class="input-group">
                <div>
                    <label>Employee Name:</label>
                    <input type="text" id="optionEmployeeName">
                </div>
                <div>
                    <label>Number of Options:</label>
                    <input type="number" id="optionCount">
                </div>
                <div>
                    <label>Strike Price:</label>
                    <input type="number" id="strikePrice" step="0.01">
                </div>
                <div>
                    <label>Grant Date:</label>
                    <input type="date" id="grantDate">
                </div>
                <div>
                    <label>Expiration Date:</label>
                    <input type="date" id="expirationDate">
                </div>
            </div>
            <button onclick="grantOptions()">Grant Options</button>

            <div id="optionsTable"></div>
        </div>
    </div>

    <!-- Vesting Tab -->
    <div id="Vesting" class="tabcontent">
        <div class="calculator-section">
            <h2>Vesting Schedules</h2>
            <div class="input-group">
                <div>
                    <label>Stakeholder:</label>
                    <select id="vestingStakeholder"></select>
                </div>
                <div>
                    <label>Vesting Period (years):</label>
                    <input type="number" id="vestingPeriod" value="4">
                </div>
                <div>
                    <label>Cliff Period (months):</label>
                    <input type="number" id="cliffPeriod" value="12">
                </div>
                <div>
                    <label>Vesting Frequency:</label>
                    <select id="vestingFrequency">
                        <option value="monthly">Monthly</option>
                        <option value="quarterly">Quarterly</option>
                        <option value="annually">Annually</option>
                    </select>
                </div>
            </div>
            <button onclick="addVestingSchedule()">Add Vesting Schedule</button>

            <div id="vestingTable"></div>
        </div>
    </div>

    <!-- Analytics Tab -->
    <div id="Analytics" class="tabcontent">
        <div class="calculator-section">
            <h2>Cap Table Analytics</h2>
            <div class="stats-container">
                <div class="stat-card">
                    <h4>Fully Diluted Shares</h4>
                    <div class="stat-value" id="fullyDilutedShares">0</div>
                </div>
                <div class="stat-card">
                    <h4>Fully Diluted Valuation</h4>
                    <div class="stat-value" id="fullyDilutedValuation">$0</div>
                </div>
                <div class="stat-card">
                    <h4>Last Round Price</h4>
                    <div class="stat-value" id="lastRoundPrice">$0</div>
                </div>
            </div>

            <h3>Ownership Distribution</h3>
            <div id="ownershipChart"></div>

            <h3>Investment History</h3>
            <div id="investmentHistory"></div>
        </div>
    </div>

    <script>
        // State Management
        let state = {
            company: {
                name: '',
                incorporationDate: null,
                fiscalYearEnd: null,
                authorizedCommon: 10000000,
                authorizedPreferred: 2000000,
                parValue: 0.0001
            },
            shareholders: [],
            investments: [],
            options: {
                pool: {
                    size: 10,
                    reserved: 0
                },
                grants: []
            },
            vestingSchedules: [],
            safeNotes: []
        };

        // Tab Management
        function openTab(evt, tabName) {
            let tabcontent = document.getElementsByClassName("tabcontent");
            for (let i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }

            let tablinks = document.getElementsByClassName("tablinks");
            for (let i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }

            document.getElementById(tabName).style.display = "block";
            evt.currentTarget.className += " active";
        }

        // Shareholders Management
        function addShareholder() {
            const shareholder = {
                type: document.getElementById('shareholderType').value,
                name: document.getElementById('shareholderName').value,
                shareClass: document.getElementById('shareClass').value,
                shares: parseInt(document.getElementById('shareCount').value),
                issuePrice: parseFloat(document.getElementById('issuePrice').value)
            };

            state.shareholders.push(shareholder);
            updateShareholdersTable();
            updateAnalytics();
        }

        function updateShareholdersTable() {
            let html = `
                <table>
                    <tr>
                        <th>Name</th>
                        <th>Type</th>
                        <th>Share Class</th>
                        <th>Shares</th>
                        <th>Issue Price</th>
                        <th>Ownership %</th>
                    </tr>
            `;

            const totalShares = calculateTotalShares();

            state.shareholders.forEach(sh => {
                html += `
                    <tr>
                        <td>${sh.name}</td>
                        <td>${sh.type}</td>
                        <td>${sh.shareClass}</td>
                        <td>${sh.shares.toLocaleString()}</td>
                        <td>$${sh.issuePrice.toFixed(4)}</td>
                        <td>${((sh.shares / totalShares) * 100).toFixed(2)}%</td>
                    </tr>
                `;
            });

            html += '</table>';
            document.getElementById('shareholdersTable').innerHTML = html;
        }

        // Investment Management
        function addInvestmentRound() {
            const investment = {
                type: document.getElementById('roundType').value,
                preMoneyValuation: parseFloat(document.getElementById('preMoneyVal').value),
                amount: parseFloat(document.getElementById('investmentAmount').value),
                pricePerShare: parseFloat(document.getElementById('pricePerShare').value),
                date: new Date()
            };

            state.investments.push(investment);
            updateInvestmentsTable();
            updateAnalytics();
        }

        function addSAFENote() {
            const safe = {
                investorName: document.getElementById('safeInvestorName').value,
                amount: parseFloat(document.getElementById('safeAmount').value),
                valuationCap: parseFloat(document.getElementById('valuationCap').value),
                discountRate: parseFloat(document.getElementById('discountRate').value),
                date: new Date()
            };

            state.safeNotes.push(safe);
            updateInvestmentsTable();
        }

        // Options Management
        function grantOptions() {
            const option = {
                employeeName: document.getElementById('optionEmployeeName').value,
                count: parseInt(document.getElementById('optionCount').value),
                strikePrice: parseFloat(document.getElementById('strikePrice').value),
                grantDate: document.getElementById('grantDate').value,
                expirationDate: document.getElementById('expirationDate').value
            };

            state.options.grants.push(option);
            updateOptionsTable();
            updateAnalytics();
        }

        // Vesting Management
        function addVestingSchedule() {
            const schedule = {
                stakeholder: document.getElementById('vestingStakeholder').value,
                period: parseInt(document.getElementById('vestingPeriod').value),
                cliff: parseInt(document.getElementById('cliffPeriod').value),
                frequency: document.getElementById('vestingFrequency').value
            };

            state.vestingSchedules.push(schedule);
            updateVestingTable();
        }

        // Utility Functions
        function calculateTotalShares() {
            return state.shareholders.reduce((total, sh) => total + sh.shares, 0);
        }

        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD'
            }).format(amount);
        }

        // Analytics
        function updateAnalytics() {
            const totalShares = calculateTotalShares();
            const fullyDiluted = totalShares + calculateTotalOptions() + calculateSAFEShares();
            
            document.getElementById('totalSharesOutstanding').textContent = totalShares.toLocaleString();
            document.getElementById('fullyDilutedShares').textContent = fullyDiluted.toLocaleString();
            
            if (state.investments.length > 0) {
                const lastRound = state.investments[state.investments.length - 1];
                document.getElementById('currentValuation').textContent = 
                    formatCurrency(lastRound.preMoneyValuation + lastRound.amount);
                document.getElementById('lastRoundPrice').textContent = 
                    formatCurrency(lastRound.pricePerShare);
            }
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Set initial tab
            document.getElementById('Overview').style.display = 'block';
            
            // Initialize any charts or visualizations
            updateAnalytics();
        });
    </script>
</body>
</html>
